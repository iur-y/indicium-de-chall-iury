version: 1
env:
  DBT_CLEAN_PROJECT_FILES_ONLY: 'false'
default_environment: dev
project_id: 1bceae40-d78c-4c96-b676-5202907a7292
environments:
- name: dev
- name: staging
- name: prod

plugins:
  extractors:

  - name: tap-postgres
    variant: meltanolabs
    pip_url: git+https://github.com/MeltanoLabs/tap-postgres.git
    config:
      database: northwind
      host: localhost
      user: northwind_user
      default_replication_method: FULL_TABLE
    catalog: catalog/tap_postgres_catalog_file.json
    select:
    - public*.*


  - name: tap-csv
    variant: meltanolabs
    pip_url: git+https://github.com/MeltanoLabs/tap-csv.git
    config:
      quotechar: '"'
      files:
      - entity: order_details
        path: loaded_data/csv/order_details-20240626T140020.csv
        keys:
        - order_id
        - product_id
      - entity: categories
        path: loaded_data/postgres/public-categories-20240626T135952.csv
        keys:
        - category_id
      - entity: customers
        path: loaded_data/postgres/public-customers-20240626T135952.csv
        keys:
        - customer_id
      - entity: employee_territories
        path: loaded_data/postgres/public-employee_territories-20240626T135952.csv
        keys:
        - employee_id
        - territory_id
      - entity: employees
        path: loaded_data/postgres/public-employees-20240626T135952.csv
        keys:
        - employee_id
      - entity: orders
        path: loaded_data/postgres/public-orders-20240626T135952.csv
        keys:
        - order_id
      - entity: products
        path: loaded_data/postgres/public-products-20240626T135952.csv
        keys:
        - product_id
      - entity: region
        path: loaded_data/postgres/public-region-20240626T135952.csv
        keys:
        - region_id
      - entity: shippers
        path: loaded_data/postgres/public-shippers-20240626T135952.csv
        keys:
        - shipper_id
      - entity: suppliers
        path: loaded_data/postgres/public-suppliers-20240626T135952.csv
        keys:
        - supplier_id
      - entity: territories
        path: loaded_data/postgres/public-territories-20240626T135952.csv
        keys:
        - territory_id
      - entity: us_states
        path: loaded_data/postgres/public-us_states-20240626T135952.csv
        keys:
        - state_id

  loaders:

  - name: target-csv
    variant: hotgluexyz
    pip_url: git+https://github.com/hotgluexyz/target-csv.git
    config:
      destination_path: loaded_data/postgres
      delimiter: ','
      quotechar: '"'


  - name: target-postgres
    variant: meltanolabs
    pip_url: meltanolabs-target-postgres
    config:
      user: northwind_user
      host: localhost
      database: newdb
      default_target_schema: public
      load_method: overwrite


  utilities:

  - name: dbt-postgres
    variant: dbt-labs
    pip_url: dbt-core dbt-postgres git+https://github.com/meltano/dbt-ext.git@main
    config:
      host: localhost
      port: 5432
      user: northwind_user
      dbname: newdb
      schema: analytics


  - name: airflow
    variant: apache
    pip_url: git+https://github.com/meltano/airflow-ext.git@main apache-airflow==2.8.1
      --constraint 
      https://raw.githubusercontent.com/apache/airflow/constraints-2.8.1/constraints-no-providers-${MELTANO__PYTHON_VERSION}.txt
    settings:
    - name: meltano.project_dir
      env: MELTANO_PROJECT_ROOT
      value: $MELTANO_PROJECT_ROOT
      label: Root Project Directory
